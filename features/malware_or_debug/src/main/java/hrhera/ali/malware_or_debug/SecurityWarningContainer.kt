package hrhera.ali.malware_or_debug

import androidx.activity.compose.BackHandler
import androidx.compose.runtime.Composable
import androidx.compose.runtime.LaunchedEffect
import androidx.hilt.navigation.compose.hiltViewModel
import androidx.lifecycle.compose.LocalLifecycleOwner
import hrhera.ali.malware_or_debug.components.EmulatorWarningScreen
import hrhera.ali.malware_or_debug.components.MalwareWarningScreen


@Composable
fun SecurityWarningContainer(
    isEmulator: Boolean = true,
    onNavigateNext: () -> Unit = {}
) {
    BackHandler {  }
    if (isEmulator) {
        val viewModel: SecurityWarningViewModel = hiltViewModel()
        val lifecycleOwner = LocalLifecycleOwner.current
        LaunchedEffect(lifecycleOwner) {
            lifecycleOwner.lifecycle.addObserver(viewModel)
        }

        EmulatorWarningScreen(viewModel.state.value.secondsLeft)
        LaunchedEffect(Unit) {
            viewModel.transitionToCounter(15, onNavigateNext)
        }
    } else {
        MalwareWarningScreen()
    }

}




